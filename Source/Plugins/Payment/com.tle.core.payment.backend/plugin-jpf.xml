<!DOCTYPE plugin PUBLIC "-//JPF//Java Plug-in Manifest 1.0" "http://jpf.sourceforge.net/plugin_1_0.dtd">
<plugin id="com.tle.core.payment.backend" version="1">
	<requires>
		<import plugin-id="com.tle.common.payment.backend" exported="true" />
		<import plugin-id="com.tle.common.dynacollection" />
		<import plugin-id="com.tle.common.i18n" />
		<import plugin-id="com.tle.core.dynacollection" />
		<import plugin-id="com.tle.core.guice" />
		<import plugin-id="com.tle.core.item" />
		<import plugin-id="com.tle.core.hibernate" />
		<import plugin-id="com.tle.core.migration" />
		<import plugin-id="com.tle.core.notification" />
		<import plugin-id="com.tle.core.entity.services" exported="true" />
		<import plugin-id="com.tle.core.freetext" />
		<import plugin-id="com.tle.core.scripting" />
		<import plugin-id="com.tle.core.security" />
		<import plugin-id="com.tle.core.settings" />
		<import plugin-id="com.tle.common.beans" />
		<import plugin-id="com.tle.core.services" />
		<import plugin-id="com.tle.common.search" />
		<import plugin-id="com.tle.core.oauth" />
		<import plugin-id="com.tle.core.workflow" />
		<import plugin-id="com.tle.common.item" />
		<import plugin-id="com.tle.core.payment.beans" />
		<import plugin-id="com.tle.web.resources" />
		<import plugin-id="com.tle.web.scripting" />
		<import plugin-id="com.tle.web.wizard" />
		<import plugin-id="org.jboss.resteasy:jaxrs-api" />
		<import plugin-id="commons-lang:commons-lang" />
		<import plugin-id="com.tle.web.api.item.equella.interfaces" />
		<import plugin-id="com.tle.web.api.item.equella.serializer" />
		<import plugin-id="com.tle.common.interfaces.equella" />
		<import plugin-id="com.tle.web.api.baseentity.serializer" />
	</requires>

	<runtime>
		<library type="code" path="classes/" id="core">
			<export prefix="*" />
		</library>
		<library type="resources" path="resources/" id="resources" />
	</runtime>

	<extension-point id="paymentGatewayType">
		<parameter-def id="id" multiplicity="one" type="string" />
		<parameter-def id="nameKey" multiplicity="one" type="string" />
		<parameter-def id="descriptionKey" multiplicity="one" type="string" />
		<parameter-def id="serviceClass" multiplicity="none-or-one" type="string" />
	</extension-point>

	<extension-point id="paymentGatewayImplementation">
		<parameter-def id="type" multiplicity="one" type="string" />
		<parameter-def id="class" multiplicity="one" type="string">
			<doc>
				<doc-text>Must implement com.tle.core.payment.gateway.PaymentGatewayImplementation</doc-text>
			</doc>
		</parameter-def>
	</extension-point>

	<extension-point id="paymentGatewayCheckoutInfo">
		<parameter-def id="type" multiplicity="one" type="string" />
		<parameter-def id="class" multiplicity="one" type="string">
			<doc>
				<doc-text>Must implement com.tle.core.payment.gateway.PaymentGatewayCheckoutInfoExtension</doc-text>
			</doc>
		</parameter-def>
	</extension-point>

	<extension plugin-id="com.tle.core.freetext" point-id="indexingExtension" id="tierIndexerExtension">
		<parameter id="class" value="bean:com.tle.core.payment.index.PaymentIndexer" />
	</extension>

	<extension plugin-id="com.tle.core.guice" point-id="module" id="guiceModules">
		<parameter id="class" value="com.tle.core.services.guice.ServicesModule" />
	</extension>

	<extension plugin-id="com.tle.common.i18n" point-id="bundle" id="strings">
		<parameter id="file" value="lang/i18n.properties" />
		<parameter id="group" value="resource-centre" />
	</extension>

	<extension plugin-id="com.tle.core.hibernate" point-id="domainObjects" id="paymentObjects">
		<parameter id="class" value="com.tle.common.payment.entity.Sale" />
		<parameter id="class" value="com.tle.common.payment.entity.SaleItem" />
		<parameter id="class" value="com.tle.common.payment.entity.Catalogue" />
		<parameter id="class" value="com.tle.common.payment.entity.Region" />
		<parameter id="class" value="com.tle.common.payment.entity.Price" />
		<parameter id="class" value="com.tle.common.payment.entity.PricingTier" />
		<parameter id="class" value="com.tle.common.payment.entity.SubscriptionPeriod" />
		<parameter id="class" value="com.tle.common.payment.entity.PricingTierAssignment" />
		<parameter id="class" value="com.tle.common.payment.entity.PaymentGateway" />
		<parameter id="class" value="com.tle.common.payment.entity.StoreFront" />
		<parameter id="class" value="com.tle.common.payment.entity.CatalogueAssignment" />
		<parameter id="class" value="com.tle.common.payment.entity.StoreHarvestInfo" />
		<parameter id="class" value="com.tle.common.payment.entity.TaxType" />
	</extension>

	<extension plugin-id="com.tle.core.migration" point-id="initialSchema" id="paymentSchemaObjects">
		<parameter id="class" value="com.tle.common.payment.entity.Catalogue" />
		<parameter id="class" value="com.tle.common.payment.entity.Region" />
		<parameter id="index">
			<parameter id="table" value="region_countries" />
			<parameter id="name" value="regc_region" />
			<parameter id="column" value="region_id" />
		</parameter>
		<parameter id="class" value="com.tle.common.payment.entity.Price" />
		<parameter id="class" value="com.tle.common.payment.entity.PricingTier" />
		<parameter id="class" value="com.tle.common.payment.entity.SubscriptionPeriod" />
		<parameter id="class" value="com.tle.common.payment.entity.PricingTierAssignment" />
		<parameter id="class" value="com.tle.common.payment.entity.PaymentGateway" />
		<parameter id="class" value="com.tle.common.payment.entity.StoreFront" />
		<parameter id="class" value="com.tle.common.payment.entity.CatalogueAssignment" />
		<parameter id="class" value="com.tle.common.payment.entity.Sale" />
		<parameter id="class" value="com.tle.common.payment.entity.SaleItem" />
		<parameter id="class" value="com.tle.common.payment.entity.StoreHarvestInfo" />
		<parameter id="class" value="com.tle.common.payment.entity.TaxType" />
	</extension>

	<extension plugin-id="com.tle.core.migration" point-id="migration" id="createPaymentSchema">
		<parameter id="id" value="com.tle.core.payment.migration.CreatePaymentEntities" />
		<parameter id="bean" value="bean:com.tle.core.payment.migration.CreatePaymentSchema" />
		<parameter id="depends" value="com.tle.core.payment.migration.CreateTaxTypeSchema" />
		<parameter id="date" value="2012-05-28" />
	</extension>

	<extension plugin-id="com.tle.core.migration" point-id="migration" id="createTaxTypeSchema">
		<parameter id="id" value="com.tle.core.payment.migration.CreateTaxTypeSchema" />
		<parameter id="bean" value="bean:com.tle.core.payment.migration.CreateTaxTypeSchema" />
		<parameter id="date" value="2012-10-10" />
	</extension>

	<extension plugin-id="com.tle.core.migration" point-id="migration" id="addTaxToStorefront">
		<parameter id="id" value="com.tle.core.payment.migration.StorefrontTaxMigration" />
		<parameter id="bean" value="bean:com.tle.core.payment.migration.StorefrontTaxMigration" />
		<parameter id="obsoletedby" value="com.tle.core.payment.migration.CreatePaymentEntities" />
		<parameter id="depends" value="com.tle.core.payment.migration.CreateTaxTypeSchema" />
		<parameter id="date" value="2012-10-11" />
	</extension>

	<extension plugin-id="com.tle.core.migration" point-id="migration" id="addTaxFieldsSchema">
		<parameter id="id" value="com.tle.core.payment.migration.AddTaxFieldsMigration" />
		<parameter id="bean" value="bean:com.tle.core.payment.migration.AddTaxFieldsMigration" />
		<parameter id="obsoletedby" value="com.tle.core.payment.migration.CreatePaymentEntities" />
		<parameter id="date" value="2012-10-11" />
	</extension>

	<extension plugin-id="com.tle.core.migration" point-id="migration" id="createPaymentObjects">
		<parameter id="id" value="com.tle.core.payment.migration.CreateDefaultPaymentObjects" />
		<parameter id="bean" value="bean:com.tle.core.payment.migration.CreateDefaultPaymentObjectsDatabaseMigration" />
		<parameter id="depends" value="com.tle.core.payment.migration.CreatePaymentEntities" />
		<parameter id="date" value="2012-05-28" />
	</extension>

	<extension plugin-id="com.tle.core.migration" point-id="migration" id="addForeignIndexes">
		<parameter id="id" value="com.tle.core.payment.migration.AddForeignIndexes" />
		<parameter id="bean" value="bean:com.tle.core.payment.migration.AddForeignIndexes" />
		<parameter id="obsoletedby" value="com.tle.core.payment.migration.CreatePaymentEntities" />
		<parameter id="date" value="2012-10-31" />
	</extension>

	<extension plugin-id="com.tle.core.security" point-id="privilegeTreeProviders" id="privilegeTreeProvider">
		<parameter id="provider" value="bean:com.tle.core.payment.privileges.RegionPrivilegeTreeProvider" />
		<parameter id="provider" value="bean:com.tle.core.payment.privileges.CataloguePrivilegeTreeProvider" />
		<parameter id="provider" value="bean:com.tle.core.payment.privileges.PricingTierPrivilegeTreeProvider" />
		<parameter id="provider" value="bean:com.tle.core.payment.privileges.PaymentGatewayPrivilegeTreeProvider" />
		<parameter id="provider" value="bean:com.tle.core.payment.privileges.StorefrontPrivilegeTreeProvider" />
		<parameter id="provider" value="bean:com.tle.core.payment.privileges.TaxPrivilegeTreeProvider" />
	</extension>

	<extension plugin-id="com.tle.core.entity.services" point-id="entityService" id="catService">
		<parameter id="serviceClass" value="bean:com.tle.core.payment.service.CatalogueService" />
		<parameter id="order" value="1000" />
	</extension>

	<extension plugin-id="com.tle.core.entity.services" point-id="entityService" id="paygatewayService">
		<parameter id="serviceClass" value="bean:com.tle.core.payment.service.PaymentGatewayService" />
		<parameter id="order" value="1000" />
	</extension>

	<extension plugin-id="com.tle.core.entity.services" point-id="entityService" id="tierService">
		<parameter id="serviceClass" value="bean:com.tle.core.payment.service.PricingTierService" />
		<parameter id="order" value="1000" />
	</extension>

	<extension plugin-id="com.tle.core.entity.services" point-id="entityService" id="regionService">
		<parameter id="serviceClass" value="bean:com.tle.core.payment.service.RegionService" />
		<parameter id="order" value="1000" />
	</extension>

	<extension plugin-id="com.tle.core.entity.services" point-id="entityService" id="storefrontService">
		<parameter id="serviceClass" value="bean:com.tle.core.payment.service.StoreFrontService" />
		<parameter id="order" value="3000" />
	</extension>

	<extension plugin-id="com.tle.core.entity.services" point-id="entityService" id="taxService">
		<parameter id="serviceClass" value="bean:com.tle.core.payment.service.TaxService" />
		<parameter id="order" value="2000" />
	</extension>

	<extension plugin-id="com.tle.core.entity.services" point-id="itemDaoExtension" id="PricingTierAssignmentItemDao">
		<parameter id="class" value="bean:com.tle.core.payment.dao.PricingTierAssignmentDao" />
		<parameter id="order" value="200" />
	</extension>

	<extension plugin-id="com.tle.core.services" point-id="applicationEventListener" id="cataloguedeletionlisteners">
		<parameter id="listener" value="bean:com.tle.core.payment.service.CatalogueService" />
		<parameter id="listenerClass" value="com.tle.core.payment.events.listeners.RegionDeletionListener" />
		<parameter id="listenerClass" value="com.tle.core.payment.events.listeners.RegionReferencesListener" />
		<parameter id="listenerClass" value="com.tle.core.events.listeners.ItemDeletedListener" />
		<parameter id="listenerClass" value="com.tle.core.events.listeners.UserChangeListener" />
		<parameter id="listenerClass" value="com.tle.core.dynacollection.DynaCollectionReferencesListener" />
	</extension>

	<extension plugin-id="com.tle.core.services" point-id="applicationEventListener" id="pricingtierdeletionlisteners">
		<parameter id="listener" value="bean:com.tle.core.payment.service.PricingTierService" />
		<parameter id="listenerClass" value="com.tle.core.events.listeners.ItemDeletedListener" />
		<parameter id="listenerClass" value="com.tle.core.events.listeners.UserChangeListener" />
	</extension>

	<extension plugin-id="com.tle.core.services" point-id="applicationEventListener" id="gatewaydeletionlisteners">
		<parameter id="listener" value="bean:com.tle.core.payment.service.PaymentGatewayService" />
		<parameter id="listenerClass" value="com.tle.core.payment.events.listeners.RegionDeletionListener" />
		<parameter id="listenerClass" value="com.tle.core.payment.events.listeners.RegionReferencesListener" />
		<parameter id="listenerClass" value="com.tle.core.events.listeners.UserChangeListener" />
	</extension>

	<extension plugin-id="com.tle.core.services" point-id="applicationEventListener" id="paymentdeletionlisteners">
		<parameter id="listener" value="bean:com.tle.core.payment.service.PaymentService" />
		<parameter id="listenerClass" value="com.tle.core.payment.events.listeners.CatalogueDeletionListener" />
		<parameter id="listenerClass" value="com.tle.core.payment.events.listeners.CatalogueReferencesListener" />
		<parameter id="listenerClass" value="com.tle.core.payment.events.listeners.RegionDeletionListener" />
		<parameter id="listenerClass" value="com.tle.core.payment.events.listeners.RegionReferencesListener" />
		<parameter id="listenerClass" value="com.tle.core.payment.events.listeners.PricingTierDeletionListener" />
	</extension>

	<extension plugin-id="com.tle.core.services" point-id="applicationEventListener" id="storefrontlisteners">
		<parameter id="listener" value="bean:com.tle.core.payment.service.StoreFrontService" />
		<parameter id="listenerClass" value="com.tle.core.oauth.service.OAuthClientReferencesListener" />
		<parameter id="listenerClass" value="com.tle.core.events.listeners.UserChangeListener" />
		<parameter id="listenerClass" value="com.tle.core.payment.events.listeners.TaxTypeReferencesListener" />
	</extension>

	<extension plugin-id="com.tle.core.services" point-id="applicationEventListener" id="regionlisteners">
		<parameter id="listener" value="bean:com.tle.core.payment.service.RegionService" />
		<parameter id="listenerClass" value="com.tle.core.events.listeners.UserChangeListener" />
	</extension>

	<extension plugin-id="com.tle.core.services" point-id="applicationEventListener" id="taxlisteners">
		<parameter id="listener" value="bean:com.tle.core.payment.service.TaxService" />
		<parameter id="listenerClass" value="com.tle.core.events.listeners.UserChangeListener" />
	</extension>

	<extension plugin-id="com.tle.core.entity.services" point-id="converter" id="subsperiodConverter">
		<parameter id="id" value="SUBSPERIOD" />
		<parameter id="class" value="bean:com.tle.core.payment.converter.SubscriptionPeriodConverter" />
		<parameter id="order" value="3000" />

		<parameter id="selections">
			<parameter id="id" value="SUBSPERIOD" />
			<parameter id="nameKey" value="com.tle.core.payment.converter.period.name" />
		</parameter>
	</extension>

	<extension plugin-id="com.tle.core.entity.services" point-id="converter" id="priceConverter">
		<parameter id="id" value="PRICE" />
		<parameter id="class" value="bean:com.tle.core.payment.converter.PriceConverter" />
		<parameter id="order" value="3100" />

		<parameter id="selections">
			<parameter id="id" value="PRICE" />
			<parameter id="nameKey" value="com.tle.core.payment.converter.price.name" />
		</parameter>
	</extension>

	<extension plugin-id="com.tle.core.entity.services" point-id="converter" id="paymentConverter">
		<parameter id="id" value="PAYMENT" />
		<parameter id="class" value="bean:com.tle.core.payment.converter.PaymentConverter" />
		<parameter id="order" value="3200" />

		<parameter id="selections">
			<parameter id="id" value="PAYMENT" />
			<parameter id="nameKey" value="com.tle.core.payment.converter.payment.name" />
		</parameter>
	</extension>

	<extension plugin-id="com.tle.core.entity.services" point-id="converter" id="saleConverter">
		<parameter id="id" value="SALE" />
		<parameter id="class" value="bean:com.tle.core.payment.converter.SaleConverter" />
		<parameter id="order" value="3300" />

		<parameter id="selections">
			<parameter id="id" value="SALE" />
			<parameter id="nameKey" value="com.tle.core.payment.converter.sale.name" />
		</parameter>
	</extension>

	<extension plugin-id="com.tle.core.entity.services" point-id="xmlmigration" id="createDefaultPaymentXmlConvert">
		<parameter id="id" value="com.tle.core.payment.migration.xml.CreateDefaultPaymentObjectsXmlMigration" />
		<parameter id="bean" value="bean:com.tle.core.payment.migration.xml.CreateDefaultPaymentObjectsXmlMigration" />
	</extension>

	<extension plugin-id="com.tle.core.security" point-id="privilegeTreeProviders" id="storeSettingsPrivilegeTreeProvider">
		<parameter id="provider" value="bean:com.tle.core.payment.StoreSettingsPrivilegeTreeProvider" />
	</extension>

	<extension plugin-id="com.tle.web.wizard" point-id="scriptObjects" id="paymentWizardScriptObjects">
		<parameter id="id" value="paymentWizardScriptObjects" />
		<parameter id="class" value="bean:com.tle.core.payment.scripting.contributor.PaymentScriptObjectContributor" />
	</extension>

	<extension plugin-id="com.tle.core.scripting" point-id="scriptObjects" id="paymentCoreScriptObjects">
		<parameter id="id" value="paymentCoreScriptObjects" />
		<parameter id="class" value="bean:com.tle.core.payment.scripting.contributor.PaymentScriptObjectContributor" />
	</extension>

	<extension plugin-id="com.tle.core.workflow" point-id="operation" id="cloneCatsAndTiersOperation">
		<parameter id="type" value="postClone" />
		<parameter id="class" value="bean:com.tle.core.payment.operation.CloneCataloguesAndTiersOperationGenerator" />
	</extension>
</plugin>
