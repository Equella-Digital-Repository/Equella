<project name="Coverage">

	<property name="report-output" location="standard-report" />
	<property name="source-base" location="source" />

	<target name="init">
		<taskdef resource="emma_ant.properties">
			<classpath>
				<pathelement location="lib/emma.jar" />
				<pathelement location="lib/emma_ant.jar" />
			</classpath>
		</taskdef>
	</target>

	<target name="clean">
		<delete dir="${report-output}" />
		<delete dir="${source-base}" />
	</target>
	
	<target name="prep-source">
		<unzip src="source.zip" dest="${source-base}" />
	</target>

	<target name="report" depends="init,prep-source">
		<emma>
			<report >
				<fileset dir=".">
					<include name="metadata.em" />
					<include name="*.ec" />
					<exclude name="coverage-unittests.ec" />
				</fileset>

				<sourcepath>
					<dirset dir="${source-base}">
						<include name="**/src" />
					</dirset>
				</sourcepath>

				<html outfile="${report-output}/index.html" />
			</report>
		</emma>
	</target>
</project>
